import{d as R,s as k,r as V,p as Z,c as j,a as _,b as e,w as l,e as n,K as F,E as G,i as r,x as J,y as L,z as $,l as q,t as p,o as x,_ as O}from"./index-jbbSaPHq.js";const Q={class:"admin-user-management page-shell"},W={class:"page-header"},X={class:"user-info"},Y={class:"user-name"},ee={class:"user-email"},le={class:"table-footer"},ae=R({__name:"UserManagement",setup(te){const o=k({keyword:"",role:"",isActive:void 0,sortBy:"id_asc"}),i=k({page:1,pageSize:10,total:0}),A=V([]),h=V(!1),S={background:"rgba(13, 17, 23, 0.65)",color:"#cdd9e5"},f=async()=>{h.value=!0;try{const s={page:i.page,pageSize:i.pageSize,keyword:o.keyword||void 0,role:o.role||void 0,isActive:o.isActive??void 0,sortBy:o.sortBy||"id_asc"},c=(await F({url:"/admin/users",method:"get",params:s})).data||{},y=c.users||c.list||c.items||[];A.value=Array.isArray(y)?y:[],i.total=Number(c.total)||0,i.page=Number(c.page)||s.page||1,i.pageSize=Number(c.pageSize)||s.pageSize||10}catch(s){console.error(s),G.error("获取用户列表失败")}finally{h.value=!1}},g=()=>{i.page=1,f()},D=()=>{o.keyword="",o.role=void 0,o.isActive=void 0,o.sortBy="id_asc",g()},U=s=>{i.page=s,f()},N=s=>{i.pageSize=s,i.page=1,f()},C=s=>({ADMIN:"管理员",TEACHER:"教师",STUDENT:"学生"})[(s||"").toUpperCase()]||"未知",u=k({visible:!1,user:null}),B=s=>{u.user=s,u.visible=!0};return Z(f),(s,a)=>{const c=n("el-button"),y=n("el-input"),v=n("el-form-item"),d=n("el-option"),w=n("el-select"),E=n("el-form"),m=n("el-table-column"),z=n("el-tag"),I=n("el-table"),T=n("el-pagination"),M=n("el-card"),b=n("el-descriptions-item"),K=n("el-descriptions"),H=n("el-drawer"),P=$("loading");return x(),j("div",Q,[_("div",W,[a[6]||(a[6]=_("div",null,[_("h2",{class:"page-header__title"},"用户管理"),_("p",{class:"page-header__subtitle"},"查看系统用户、筛选角色及状态，支持快速查看明细。")],-1)),e(c,{type:"info",plain:"",onClick:f},{default:l(()=>[...a[5]||(a[5]=[r("刷新",-1)])]),_:1})]),e(M,{class:"page-card"},{default:l(()=>[e(E,{inline:!0,model:o,"label-suffix":":",class:"filter-form"},{default:l(()=>[e(v,{label:"关键字"},{default:l(()=>[e(y,{modelValue:o.keyword,"onUpdate:modelValue":a[0]||(a[0]=t=>o.keyword=t),placeholder:"昵称 / 邮箱 / 学号",clearable:"",onKeyup:L(g,["enter"]),style:{width:"200px"}},null,8,["modelValue"])]),_:1}),e(v,{label:"角色"},{default:l(()=>[e(w,{modelValue:o.role,"onUpdate:modelValue":a[1]||(a[1]=t=>o.role=t),placeholder:"全部",clearable:"",onChange:g,style:{width:"120px"}},{default:l(()=>[e(d,{label:"管理员",value:"ADMIN"}),e(d,{label:"教师",value:"TEACHER"}),e(d,{label:"评委",value:"JUDGE"}),e(d,{label:"学生",value:"STUDENT"})]),_:1},8,["modelValue"])]),_:1}),e(v,{label:"状态"},{default:l(()=>[e(w,{modelValue:o.isActive,"onUpdate:modelValue":a[2]||(a[2]=t=>o.isActive=t),placeholder:"全部",clearable:"",onChange:g,style:{width:"120px"}},{default:l(()=>[e(d,{label:"启用",value:1}),e(d,{label:"停用",value:0})]),_:1},8,["modelValue"])]),_:1}),e(v,{label:"排序"},{default:l(()=>[e(w,{modelValue:o.sortBy,"onUpdate:modelValue":a[3]||(a[3]=t=>o.sortBy=t),placeholder:"默认排序",clearable:"",onChange:g,style:{width:"140px"}},{default:l(()=>[e(d,{label:"最新注册",value:"created_desc"}),e(d,{label:"最早注册",value:"created_asc"}),e(d,{label:"ID升序",value:"id_asc"}),e(d,{label:"ID降序",value:"id_desc"}),e(d,{label:"昵称A-Z",value:"nickname_asc"}),e(d,{label:"昵称Z-A",value:"nickname_desc"})]),_:1},8,["modelValue"])]),_:1}),e(v,null,{default:l(()=>[e(c,{type:"primary",onClick:g},{default:l(()=>[...a[7]||(a[7]=[r("查询",-1)])]),_:1}),e(c,{onClick:D},{default:l(()=>[...a[8]||(a[8]=[r("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"]),J((x(),q(I,{data:A.value,border:"","header-cell-style":S,class:"user-table"},{default:l(()=>[e(m,{prop:"userId",label:"ID",width:"80",align:"center"}),e(m,{label:"用户信息","min-width":"220"},{default:l(({row:t})=>[_("div",X,[_("span",Y,p(t.nickname||"未设置昵称"),1),_("span",ee,p(t.email||"未绑定邮箱"),1)])]),_:1}),e(m,{prop:"studentId",label:"学号","min-width":"140"}),e(m,{label:"角色",width:"120",align:"center"},{default:l(({row:t})=>[e(z,{type:"info",effect:"plain"},{default:l(()=>[r(p(C(t.role)),1)]),_:2},1024)]),_:1}),e(m,{label:"状态",width:"120",align:"center"},{default:l(({row:t})=>[e(z,{type:t.isActive?"success":"danger"},{default:l(()=>[r(p(t.isActive?"启用":"停用"),1)]),_:2},1032,["type"])]),_:1}),e(m,{prop:"createdAt",label:"注册时间","min-width":"160"}),e(m,{label:"操作",width:"140",fixed:"right"},{default:l(({row:t})=>[e(c,{type:"primary",text:"",size:"small",onClick:oe=>B(t)},{default:l(()=>[...a[9]||(a[9]=[r("查看详情",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[P,h.value]]),_("div",le,[e(T,{background:"",layout:"total, sizes, prev, pager, next, jumper","current-page":i.page,"page-size":i.pageSize,total:i.total,"page-sizes":[10,20,30,50],onSizeChange:N,onCurrentChange:U},null,8,["current-page","page-size","total"])])]),_:1}),e(H,{modelValue:u.visible,"onUpdate:modelValue":a[4]||(a[4]=t=>u.visible=t),title:"用户详情",size:"420px",class:"user-detail-drawer"},{default:l(()=>[e(K,{column:"1",border:!0,size:"small"},{default:l(()=>[e(b,{label:"用户 ID"},{default:l(()=>[r(p(u.user?.userId||"-"),1)]),_:1}),e(b,{label:"昵称"},{default:l(()=>[r(p(u.user?.nickname||"-"),1)]),_:1}),e(b,{label:"邮箱"},{default:l(()=>[r(p(u.user?.email||"-"),1)]),_:1}),e(b,{label:"手机号"},{default:l(()=>[r(p(u.user?.phoneNumber||"-"),1)]),_:1}),e(b,{label:"角色"},{default:l(()=>[r(p(C(u.user?.role)),1)]),_:1}),e(b,{label:"状态"},{default:l(()=>[r(p(u.user?.isActive?"启用":"停用"),1)]),_:1}),e(b,{label:"注册时间"},{default:l(()=>[r(p(u.user?.createdAt||"-"),1)]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}}),ne=O(ae,[["__scopeId","data-v-ab43297b"]]);export{ne as default};
