import{d as G,r as b,p as O,c as T,a as n,x as V,t as o,b as e,w as t,e as c,z,l as A,q as R,g as U,E as k,i,f as F,o as h,_ as M}from"./index-jbbSaPHq.js";import{a as $,b as q}from"./training-Cgu9WEGG.js";const j={class:"training-detail-page page-shell"},J={class:"page-header"},K={class:"page-header__title"},Q={class:"page-header__subtitle"},W={class:"header-actions"},X={class:"card-header"},Y={class:"card-header"},Z={class:"card-subtitle"},ee={class:"card-header"},te={class:"card-subtitle"},ae={class:"progress-stats"},se=G({__name:"detail",setup(le){const E=U(),C=F(),f=b(!1),r=b({planId:0,title:"",description:"",status:"SCHEDULE",startTime:"",endTime:"",creatorId:0,studentCount:0,contestCount:0,contests:[],students:[]}),p=b(null),I=s=>({SCHEDULE:"未开始",ONGOING:"进行中",FINISHED:"已结束"})[s||""]||"未知",w=s=>({SCHEDULE:"info",ONGOING:"success",FINISHED:"warning"})[s||""]||"info",_=s=>s?s.replace("T"," ").substring(0,16):"-",N=async()=>{f.value=!0;try{const s=Number(E.params.id),a=await $(s);r.value=a.data||r.value;try{const u=await q(s);p.value=u.data}catch(u){console.log("获取进度统计失败:",u)}}catch(s){console.error("获取训练计划详情失败:",s),k.error(s?.message||"获取训练计划详情失败")}finally{f.value=!1}},x=()=>{C.push({name:"TrainingPlanList"})},S=s=>{C.push({name:"ContestDetail",params:{id:s}})},P=s=>{k.info("功能开发中")};return O(()=>{N()}),(s,a)=>{const u=c("el-button"),y=c("el-tag"),m=c("el-descriptions-item"),B=c("el-descriptions"),v=c("el-card"),d=c("el-table-column"),D=c("el-table"),g=c("el-statistic"),H=z("loading");return h(),T("div",j,[n("div",J,[n("div",null,[n("h2",K,o(r.value.title||"训练计划详情"),1),n("p",Q,o(r.value.description||"查看训练计划的详细信息和进度"),1)]),n("div",W,[e(u,{text:"",type:"primary",onClick:x},{default:t(()=>[...a[0]||(a[0]=[i("返回列表",-1)])]),_:1})])]),V((h(),T("div",null,[e(v,{class:"info-card"},{header:t(()=>[n("div",X,[a[1]||(a[1]=n("span",{class:"card-title"},"基本信息",-1)),e(y,{type:w(r.value.status)},{default:t(()=>[i(o(I(r.value.status)),1)]),_:1},8,["type"])])]),default:t(()=>[e(B,{column:2,border:""},{default:t(()=>[e(m,{label:"计划ID"},{default:t(()=>[i(o(r.value.planId),1)]),_:1}),e(m,{label:"开始时间"},{default:t(()=>[i(o(_(r.value.startTime)),1)]),_:1}),e(m,{label:"结束时间"},{default:t(()=>[i(o(_(r.value.endTime)),1)]),_:1}),e(m,{label:"赛事数量"},{default:t(()=>[i(o(r.value.contestCount||0),1)]),_:1}),e(m,{label:"学生数量"},{default:t(()=>[i(o(r.value.studentCount||0),1)]),_:1})]),_:1})]),_:1}),e(v,{class:"section-card"},{header:t(()=>[n("div",Y,[a[2]||(a[2]=n("span",{class:"card-title"},"包含的赛事",-1)),n("span",Z,o(r.value.contests?.length||0)+" 场赛事",1)])]),default:t(()=>[e(D,{data:r.value.contests,border:""},{default:t(()=>[e(d,{prop:"contestId",label:"赛事ID",width:"100",align:"center"}),e(d,{prop:"title",label:"赛事名称","min-width":"200"}),e(d,{prop:"status",label:"状态",width:"120",align:"center"},{default:t(({row:l})=>[e(y,{type:w(l.status)},{default:t(()=>[i(o(I(l.status)),1)]),_:2},1032,["type"])]),_:1}),e(d,{prop:"startTime",label:"开始时间",width:"180"},{default:t(({row:l})=>[i(o(_(l.startTime)),1)]),_:1}),e(d,{prop:"endTime",label:"结束时间",width:"180"},{default:t(({row:l})=>[i(o(_(l.endTime)),1)]),_:1}),e(d,{prop:"studentCount",label:"学生数",width:"120",align:"center"},{default:t(({row:l})=>[i(o(l.studentCount??0),1)]),_:1}),e(d,{prop:"contestCount",label:"赛事数",width:"120",align:"center"},{default:t(({row:l})=>[i(o(l.contestCount??0),1)]),_:1}),e(d,{label:"操作",width:"120",align:"center"},{default:t(({row:l})=>[e(u,{size:"small",text:"",type:"primary",onClick:L=>S(l.contestId)},{default:t(()=>[...a[3]||(a[3]=[i(" 查看赛事 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1}),e(v,{class:"section-card"},{header:t(()=>[n("div",ee,[a[4]||(a[4]=n("span",{class:"card-title"},"参与学生",-1)),n("span",te,o(r.value.students?.length||0)+" 名学生",1)])]),default:t(()=>[e(D,{data:r.value.students,border:""},{default:t(()=>[e(d,{prop:"userId",label:"用户ID",width:"100",align:"center"}),e(d,{prop:"nickname",label:"昵称","min-width":"150"}),e(d,{prop:"enrolledAt",label:"加入时间",width:"180"},{default:t(({row:l})=>[i(o(_(l.enrolledAt)),1)]),_:1}),e(d,{label:"操作",width:"120",align:"center"},{default:t(({row:l})=>[e(u,{size:"small",text:"",type:"primary",onClick:L=>P(l.userId)},{default:t(()=>[...a[5]||(a[5]=[i(" 查看进度 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1}),p.value?(h(),A(v,{key:0,class:"section-card"},{header:t(()=>[...a[6]||(a[6]=[n("div",{class:"card-header"},[n("span",{class:"card-title"},"整体进度")],-1)])]),default:t(()=>[n("div",ae,[e(g,{title:"平均完成率",value:p.value.averageCompletion,suffix:"%"},null,8,["value"]),e(g,{title:"总提交数",value:p.value.totalSubmissions},null,8,["value"]),e(g,{title:"通过题目数",value:p.value.totalAccepted},null,8,["value"])])]),_:1})):R("",!0)])),[[H,f.value]])])}}}),re=M(se,[["__scopeId","data-v-d0d88c69"]]);export{re as default};
