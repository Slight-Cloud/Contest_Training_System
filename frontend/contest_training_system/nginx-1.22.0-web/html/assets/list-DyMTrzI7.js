import{d as R,r as I,s as C,p as P,c as K,a as p,b as e,w as t,e as d,E as W,x as J,y as w,i as _,z as $,l as j,t as y,f as F,o as V,_ as q}from"./index-jbbSaPHq.js";import{g as G}from"./submission-B-N4RVi_.js";const H={class:"submission-list-page page-shell"},O={class:"resource-column"},Q={class:"table-footer"},X=R({__name:"list",setup(Y){const z=F(),h=I([]),b=I(!1),l=C({contestId:"",problemId:"",result:"",language:"",sortBy:"id_desc"}),r=C({page:1,pageSize:10,total:0}),x={background:"rgba(13, 17, 23, 0.65)",color:"#cdd9e5"},m=async()=>{b.value=!0;try{const s={page:r.page,pageSize:r.pageSize,contestId:l.contestId?Number(l.contestId):void 0,problemId:l.problemId?Number(l.problemId):void 0,result:l.result||void 0,language:l.language||void 0,sortBy:l.sortBy||"id_desc"},i=(await G(s)).data;i&&(h.value=i.submissions||i.list||[],r.total=i.total||0,r.page=i.page||s.page||1,r.pageSize=i.pageSize||s.pageSize||10)}catch(s){console.error("获取提交记录错误:",s),W.error(`获取提交记录失败: ${s.message||"未知错误"}`)}finally{b.value=!1}},c=()=>{r.page=1,m()},D=()=>{l.contestId="",l.problemId="",l.result="",l.language="",l.sortBy="id_desc",r.page=1,m()},E=s=>{r.page=s,m()},S=s=>{r.pageSize=s,r.page=1,m()},B=s=>({AC:"success",WA:"danger",TLE:"warning",MLE:"warning",RE:"danger",CE:"info"})[s]||"info",k=s=>{z.push({name:"SubmissionDetail",params:{id:s}})};return P(m),(s,a)=>{const i=d("el-input"),g=d("el-form-item"),n=d("el-option"),f=d("el-select"),v=d("el-button"),L=d("el-form"),u=d("el-table-column"),M=d("el-tag"),A=d("el-table"),T=d("el-pagination"),U=d("el-card"),N=$("loading");return V(),K("div",H,[a[8]||(a[8]=p("div",{class:"page-header"},[p("h2",{class:"page-header__title"},"提交记录"),p("p",{class:"page-header__subtitle"},"查看所有提交记录和评测结果")],-1)),e(U,{class:"page-card"},{default:t(()=>[e(L,{inline:!0,model:l,"label-suffix":":",class:"filter-form"},{default:t(()=>[e(g,{label:"赛事ID"},{default:t(()=>[e(i,{modelValue:l.contestId,"onUpdate:modelValue":a[0]||(a[0]=o=>l.contestId=o),placeholder:"赛事ID",clearable:"",onKeyup:w(c,["enter"]),style:{width:"120px"}},null,8,["modelValue"])]),_:1}),e(g,{label:"题目ID"},{default:t(()=>[e(i,{modelValue:l.problemId,"onUpdate:modelValue":a[1]||(a[1]=o=>l.problemId=o),placeholder:"题目ID",clearable:"",onKeyup:w(c,["enter"]),style:{width:"120px"}},null,8,["modelValue"])]),_:1}),e(g,{label:"结果"},{default:t(()=>[e(f,{modelValue:l.result,"onUpdate:modelValue":a[2]||(a[2]=o=>l.result=o),placeholder:"全部",clearable:"",onChange:c,style:{width:"120px"}},{default:t(()=>[e(n,{label:"通过(AC)",value:"AC"}),e(n,{label:"答案错误(WA)",value:"WA"}),e(n,{label:"时间超限(TLE)",value:"TLE"}),e(n,{label:"内存超限(MLE)",value:"MLE"}),e(n,{label:"运行错误(RE)",value:"RE"}),e(n,{label:"编译错误(CE)",value:"CE"})]),_:1},8,["modelValue"])]),_:1}),e(g,{label:"语言"},{default:t(()=>[e(f,{modelValue:l.language,"onUpdate:modelValue":a[3]||(a[3]=o=>l.language=o),placeholder:"全部",clearable:"",onChange:c,style:{width:"120px"}},{default:t(()=>[e(n,{label:"C++",value:"C++"}),e(n,{label:"Java",value:"Java"}),e(n,{label:"Python",value:"Python"})]),_:1},8,["modelValue"])]),_:1}),e(g,{label:"排序"},{default:t(()=>[e(f,{modelValue:l.sortBy,"onUpdate:modelValue":a[4]||(a[4]=o=>l.sortBy=o),placeholder:"默认排序",clearable:"",onChange:c,style:{width:"140px"}},{default:t(()=>[e(n,{label:"最新提交",value:"id_desc"}),e(n,{label:"最早提交",value:"id_asc"}),e(n,{label:"创建时间降序",value:"created_desc"}),e(n,{label:"创建时间升序",value:"created_asc"}),e(n,{label:"用时最少",value:"time_used_asc"}),e(n,{label:"用时最多",value:"time_used_desc"})]),_:1},8,["modelValue"])]),_:1}),e(g,null,{default:t(()=>[e(v,{type:"primary",onClick:c},{default:t(()=>[...a[5]||(a[5]=[_("查询",-1)])]),_:1}),e(v,{onClick:D},{default:t(()=>[...a[6]||(a[6]=[_("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"]),J((V(),j(A,{data:h.value,border:"","header-cell-style":x,class:"submission-table"},{default:t(()=>[e(u,{prop:"submissionId",label:"ID",width:"80",align:"center"}),e(u,{prop:"userId",label:"用户ID",width:"100",align:"center"}),e(u,{prop:"problemId",label:"题目ID",width:"100",align:"center"}),e(u,{prop:"contestId",label:"赛事ID",width:"100",align:"center"}),e(u,{prop:"result",label:"结果",width:"120",align:"center"},{default:t(({row:o})=>[e(M,{type:B(o.result),size:"small"},{default:t(()=>[_(y(o.result||"-"),1)]),_:2},1032,["type"])]),_:1}),e(u,{prop:"language",label:"语言",width:"120",align:"center"}),e(u,{label:"资源使用",width:"180",align:"center"},{default:t(({row:o})=>[p("div",O,[p("span",null,"时间: "+y(o.timeUsed||0)+"ms",1),p("span",null,"内存: "+y(o.memoryUsed||0)+"MB",1)])]),_:1}),e(u,{prop:"createdAt",label:"提交时间",width:"180"}),e(u,{label:"操作",width:"120",fixed:"right",align:"center"},{default:t(({row:o})=>[e(v,{size:"small",text:"",type:"primary",onClick:Z=>k(o.submissionId)},{default:t(()=>[...a[7]||(a[7]=[_(" 查看详情 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[N,b.value]]),p("div",Q,[e(T,{background:"",layout:"total, sizes, prev, pager, next, jumper","current-page":r.page,"page-size":r.pageSize,total:r.total,"page-sizes":[10,20,30,50],onSizeChange:S,onCurrentChange:E},null,8,["current-page","page-size","total"])])]),_:1})])}}}),ae=q(X,[["__scopeId","data-v-035005db"]]);export{ae as default};
